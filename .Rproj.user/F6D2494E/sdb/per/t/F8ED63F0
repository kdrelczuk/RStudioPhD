{
    "contents" : "library(Quandl)\neurusd = Quandl(\"QUANDL/EURUSD\", start_date = \"2009-01-01\", end_date = \"2014-01-01\")\neurusdRet = Quandl(\"QUANDL/EURUSD\", start_date = \"2009-01-01\", end_date = \"2014-01-01\",transformation=\"rdiff\")\nsandp = Quandl(\"YAHOO/INDEX_GSPC\", start_date = \"2009-01-01\", end_date = \"2014-01-01\")\nsandpRet = Quandl(\"YAHOO/INDEX_GSPC\", start_date = \"2009-01-01\", end_date = \"2014-01-01\",transformation=\"rdiff\")\nnasdaq = Quandl(\"YAHOO/INDEX_NDX\", start_date = \"2009-01-01\", end_date = \"2014-01-01\")\nnasdaqRet = Quandl(\"YAHOO/INDEX_NDX\", start_date = \"2009-01-01\", end_date = \"2014-01-01\",transformation=\"rdiff\")\n\nlibrary(zoo)\nrollapply(c(1,2,3,4,5,6,7,8,9,10,11),3,sum,by=3)\n\nlibrary(TFX)\nQueryTrueFX(digits.secs=3)\n\nlibrary(wavethresh)\n\ny = c(1,1,7,9,2,8,8,6)\n\nywd = wsd(eurusd$Rate[0:512])\nywd\n\nnames(ywd)\n\nywd$filter\n\nlibrary(wavelets)\n\nhead(eurusd$open[0:255])\n\nv <- DJ.EX()$heavi\nvnoise <- v + rnorm(length(v), 0, sd=sqrt(var(v))/6)\nvnwst <- wst(vnoise)\nplot(vnwst)\nnrow(vnoise)\nvnoise\n\nrequire(biwavelet)\n# Generate a synthetic time series 's' with the same power at three distinct periods\nt1=sin(seq(from=0, to=2*5*pi, length=1000))\nt2=sin(seq(from=0, to=2*15*pi, length=1000))\nt3=sin(seq(from=0, to=2*40*pi, length=1000))\ns=t1+t2+t3\n# Compare non-corrected vs. corrected wavelet spectrum\nwt1=wt(cbind(1:1000, s))\npar(mfrow=c(1,2))\nplot(wt1, type=\"power.corr.norm\", main=\"Bias-corrected\")\nplot(wt1, type=\"power.norm\", main=\"Not-corrected\")\nx1=xwt(cbind(1:1000, s), cbind(1:1000, s))\npar(mfrow=c(1,2))\nplot(x1, type=\"power.corr.norm\", main=\"Bias-corrected\")\nplot(x1, type=\"power.norm\", main=\"Not-corrected\")\n\n# Perform wavelet clustering of three time series\nt1=cbind(1:100, sin(seq(from=0, to=10*2*pi, length.out=100)))\nt2=cbind(1:100, sin(seq(from=0, to=10*2*pi, length.out=100)+0.1*pi))\nt3=cbind(1:100, rnorm(100))\n# Compute wavelet spectra\nwt.t1=wt(t1)\nwt.t2=wt(t2)\nwt.t3=wt(t3)\n# Store all wavelet spectra into array\nw.arr=array(NA, dim=c(3, NROW(wt.t1$wave), NCOL(wt.t1$wave)))\nw.arr[1, , ]=wt.t1$wave\nw.arr[2, , ]=wt.t2$wave\nw.arr[3, , ]=wt.t3$wave\n\nw.arr.dis=wclust(w.arr)\nplot(hclust(w.arr.dis$dist.mat, method=\"ward\"), sub=\"\", main=\"\",\n     ylab=\"Dissimilarity\", hang=-1)\n\n\n\nlibrary(wmtsa)\n## calculate the DWT of linear chirp \nlinchirp <- make.signal(\"linchirp\", n=1024)\neurusd$Rate[0:512]\n\ny = c(1,1,7,9,2,8,8,6)\n\nresult   <- wavDWT(y, wavelet=\"haar\", keep.series=TRUE)\n\nnames(result)\nresult$data\n## plot the transform shifted for approximate zero \n## phase alignment \nplot(wavShift(result))\n\n## plot summary \neda.plot(result)\n\n## summarize the transform \nsummary(result)\n\nwavStackPlot.default(wavMODWT(sunspots)$data)\n\n\neurDWT = wavDWT(eurusd$Rate[0:512],wavelet=\"d4\", keep.series=TRUE)\neurDWT\nplot(eurDWT)\neurMRD = wavMRD(eurDWT)\nplot(eurMRD)\nboxplot(eurMRD)\n\neurRetDWT = wavDWT(eurusd$Rate[512:1024],wavelet=\"d4\")\neurRetMRD = wavMRD(eurRetDWT)\nplot(eurRetMRD)\nboxplot(as.matrix(eurRetMRD)[,1:9])\n\neurRetDWT = wavDWT(eurusdRet$Rate[0:512],wavelet=\"d4\")\neurRetMRD = wavMRD(eurRetDWT)\nplot(eurRetMRD)\nboxplot(as.matrix(eurRetMRD)[,1:9])\n\nplot(eurRetDWT)\n\nboxplot(eurRetMRD)\nboxplot(eurRetMRD[1:9])\nboxplot(as.matrix(eurRetMRD)[,1:9])\n\ntest = c(10,10,10,10,10,10,198,10,10,10,10,10,10,10)\ntestDWT = wavDWT(test,wavelet=\"d2\", keep.series=TRUE)\ntestMRD = wavMRD(testDWT)\npar(mfrow=c(1,1))\nplot(testMRD)\nplot(testDWT)\nboxplot(testMRD)\n\n##############################################################################\n\nlibrary(Hmisc)\nlibrary(plyr)\n\nsandp = Quandl(\"YAHOO/INDEX_GSPC\", start_date = \"2009-01-01\", end_date = \"2014-01-01\")\nnasdaq = Quandl(\"YAHOO/INDEX_NDX\", start_date = \"2009-01-01\", end_date = \"2014-01-01\")\neurusd = Quandl(\"QUANDL/EURUSD\", start_date = \"2009-01-01\", end_date = \"2014-01-01\")\n\nsandpRet = Quandl(\"YAHOO/INDEX_GSPC\", start_date = \"2009-01-01\", end_date = \"2014-01-01\",transformation=\"rdiff\")\nnasdaqRet = Quandl(\"YAHOO/INDEX_NDX\", start_date = \"2009-01-01\", end_date = \"2014-01-01\",transformation=\"rdiff\")\neurusdRet = Quandl(\"QUANDL/EURUSD\", start_date = \"2009-01-01\", end_date = \"2014-01-01\",transformation=\"rdiff\")\n\nticks = rev(sandp$Open)\n#ticks = rev(nasdaq$Open)\n#ticks = rev(eurusd$Rate)\n\n#ticks = rev(sandpRet$Open)\n#ticks = rev(nasdaqRet$Open)\n#ticks = rev(eurusdRet$Rate)\n\ngetValIndex = function(data)\n{\n  dwt = wavDWT(data,wavelet=\"d4\")\n  mrd = wavMRD(dwt)\n  #s = summary(mrd)\n  sd(apply(mrd[,1:5],1,sum))\n  #s$crystal.stat[1:5,7]\n}\n\nhasAnomaly = function(data)\n{\n  dwt = wavDWT(data,wavelet=\"d4\")\n  mrd = wavMRD(dwt)\n  mrdMat = as.matrix(mrd)\n  sdval1 = sd(mrdMat[,1])\n  sdval2 = sd(mrdMat[,2])\n  sdval3 = sd(mrdMat[,3])\n  max(c(sum(mrdMat[,1]>sdval1*2),sum(mrdMat[,2]>sdval2*2),sum(mrdMat[,3]>sdval3*2)))\n}\n\ngetRet = function(data)\n{\n  \n  (data[length(data)]-data[1])/data[1]   \n}\n\nrisk = rollapply(ticks,32,getRet,by=32)\nft = rollapply(ticks,32,getValIndex,by=32)\n#colnames(ft) = c(\"D1\",\"D2\",\"D3\",\"D4\",\"D5\")\n\nall = cbind(ft,risk,abs(risk-Lag(risk,-1)))\ncolnames(all) = c(\"D\",\"Lag0\", \"CH\")\npairs(all)\ncor(all,use=\"pairwise.complete.obs\")\n\n\n##############################################################################\n\nmrdMat\napply(mrdMat[,1:5],1,sum)\n\nhasAnomaly = function(data)\n{\n  dwt = wavDWT(data,wavelet=\"d4\")\n  mrd = wavMRD(dwt)\n  mrdMat = as.matrix(mrd)\n  sdval1 = sd(mrdMat[,1])\n  sdval2 = sd(mrdMat[,2])\n  sdval3 = sd(mrdMat[,3])\n  c(sum(mrdMat[,1]>sdval1*2),sum(mrdMat[,2]>sdval2*2),sum(mrdMat[,3]>sdval3*2))\n}\n\nft = rollapply(ticks,32,hasAnomaly,by=32)\n\n\n\nx = c(1,2,3,4,5,6)\nx[1:length(x)]\nboxplot(as.matrix(sandpMRD)[,1:5])\n\n\ngetValIndex(sandp$Open[0:32])\ns$crystal.stat[,7]\n\nplot(sandpMRD)\nboxplot(as.matrix(sandpMRD)[,1:5])\n\nsandpDWT = wavDWT(sandp$Open[512:(512+32)],wavelet=\"d4\")\nsandpMRD = wavMRD(sandpDWT)\nplot(sandpMRD)\nboxplot(as.matrix(sandpMRD)[,1:5])\n\nsandpDWT2 = wavDWT(sandp$Open[512:1024],wavelet=\"d4\")\nsandpMRD2 = wavMRD(sandpDWT2)\nplot(sandpMRD2)\nboxplot(as.matrix(sandpMRD2)[,1:9])\n\neda.plot(sandpDWT)\nsummary(sandpMRD)",
    "created" : 1399927987917.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "666637972",
    "id" : "F8ED63F0",
    "lastKnownWriteTime" : 1399928007,
    "path" : "C:/Git/RStudioPhD/Wave_VolatilityIndex_1/main.R",
    "project_path" : "Wave_VolatilityIndex_1/main.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}